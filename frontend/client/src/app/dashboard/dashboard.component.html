<app-card cdkDropListGroup>
  <!-- Add Task Button -->
  <button
    class="button-53"
    (click)="openAddTaskDialog()"
    aria-label="Add new task"
  >
    <mat-icon class="icon-pencil">edit</mat-icon>
  </button>

  <!-- Loading State -->
  @if (isLoading) {
  <mat-spinner></mat-spinner>
  }

  <!-- Error State -->
  @if (error) {
  <div class="error-message">{{ error }}</div>
  }

  <!-- Board Content -->
  @if (!isLoading && !error) {
  <!-- Todo Column -->
  <div class="board-column">
    <h2 class="column-title">To do</h2>
    <div
      id="todo-list"
      cdkDropList
      [cdkDropListData]="tasks.todo"
      class="task-list"
      (cdkDropListDropped)="drop($event)"
    >
      @for (task of state.tasks.todo; track task.id) {
      <div class="task-item todo" cdkDrag>
        <span class="task-title">{{ task.title }}</span>
        <button
          class="delete-button"
          (click)="deleteTask(task)"
          aria-label="Delete task"
        >
          <mat-icon>delete</mat-icon>
        </button>
      </div>
      }
    </div>
  </div>

  <!-- In Progress Column -->
  <div class="board-column">
    <h2 class="column-title">In Progress</h2>
    <div
      id="inprogress-list"
      cdkDropList
      [cdkDropListData]="tasks.inprogress"
      class="task-list"
      (cdkDropListDropped)="drop($event)"
    >
      @for (task of state.tasks.inprogress; track task.id) {
      <div class="task-item inprogress" cdkDrag>
        <span class="task-title">{{ task.title }}</span>
        <button
          class="delete-button"
          (click)="deleteTask(task)"
          aria-label="Delete task"
        >
          <mat-icon>delete</mat-icon>
        </button>
      </div>
      }
    </div>
  </div>

  <!-- Done Column -->
  <div class="board-column">
    <h2 class="column-title">Done</h2>
    <div
      id="done-list"
      cdkDropList
      [cdkDropListData]="tasks.done"
      class="task-list"
      (cdkDropListDropped)="drop($event)"
    >
      @for (task of state.tasks.done; track task.id) {
      <div class="task-item done" cdkDrag>
        <span class="task-title">{{ task.title }}</span>
        <button
          class="delete-button"
          (click)="deleteTask(task)"
          aria-label="Delete task"
        >
          <mat-icon>delete</mat-icon>
        </button>
      </div>
      }
    </div>
  </div>
  }
</app-card>
